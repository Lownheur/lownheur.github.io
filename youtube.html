<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OAuth 2.0 Example</title>
</head>
<body>
  <nav class="parent_nav">
    <a href="index.html" class="child_nav">Accueil</a> 
    <a href="linktree.html" class="child_nav">Linktree</a>
    <a href="youtube.html" class="child_nav">youtube api</a>
  </nav>
  <script>
    var YOUR_CLIENT_ID = '91235972960-bjuq63mbtmdemk4qsa4epb4o6c5vo1it.apps.googleusercontent.com';
    var YOUR_REDIRECT_URI = 'https://lownheur.com';
    var oauth2Endpoint = 'https://accounts.google.com/o/oauth2/v2/auth';
    var logoutEndpoint = 'https://accounts.google.com/logout';

    function generateRandomState() {
      return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
    }

    function storeParamsInHash(params) {
      window.location.hash = 'oauth2-test-params=' + encodeURIComponent(JSON.stringify(params));
    }

    function getStoredParams() {
      var hashValue = window.location.hash.substring(1);
      return hashValue ? JSON.parse(decodeURIComponent(hashValue)) : null;
    }

    function clearStoredParams() {
      window.location.hash = '';
    }

    function checkAuthorizationStatus() {
      var storedParams = getStoredParams();

      if (storedParams && storedParams['access_token']) {
        // L'utilisateur est connecté
        showUserInfo(storedParams['access_token']);
        showLogoutButton();
      } else {
        // L'utilisateur n'est pas connecté
        showLoginButton();
      }
    }

    function showUserInfo(accessToken) {
      // Utilisez l'accessToken pour effectuer des requêtes API ou afficher les informations de l'utilisateur
      console.log("User is logged in. Access Token: " + accessToken);
    }

    function showLoginButton() {
      var loginButton = document.createElement('button');
      loginButton.textContent = 'Login with Google';
      loginButton.onclick = function () {
        oauth2SignIn();
      };
      document.body.appendChild(loginButton);
    }

    function showLogoutButton() {
      var logoutButton = document.createElement('button');
      logoutButton.textContent = 'Logout';
      logoutButton.onclick = function () {
        logout();
      };
      document.body.appendChild(logoutButton);
    }

    function oauth2SignIn() {
      var state = generateRandomState();

      var params = {
        'client_id': YOUR_CLIENT_ID,
        'redirect_uri': YOUR_REDIRECT_URI,
        'scope': 'https://www.googleapis.com/auth/youtube.force-ssl',
        'state': state,
        'include_granted_scopes': 'true',
        'response_type': 'token'
      };

      storeParamsInHash(params);

      var form = document.createElement('form');
      form.setAttribute('method', 'GET');
      form.setAttribute('action', oauth2Endpoint);

      for (var p in params) {
        var input = document.createElement('input');
        input.setAttribute('type', 'hidden');
        input.setAttribute('name', p);
        input.setAttribute('value', params[p]);
        form.appendChild(input);
      }

      document.body.appendChild(form);
      form.submit();
    }

    function logout() {
      clearStoredParams();
      // Vous pouvez également rediriger l'utilisateur vers la page de déconnexion de Google
      window.location.href = logoutEndpoint;
    }

    // Vérifiez le statut d'autorisation lors du chargement de la page
    checkAuthorizationStatus();
  </script>
</body>
</html>
